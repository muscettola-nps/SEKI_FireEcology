---
title: "CedarWestRxDataAnalysis"
author: "Muscettola"
date: "2025-12-07"
output: html_document
---

#R setup

```{r}
#install packages
#install.packages(c("ggplot2", "dplyr", "tidyverse"))

#load libraries
library(dplyr)
library(tidyverse)
library(ggplot2)

#set working directory
path_data <- "S:/Protection/Fire/Ecology/effects/FireEffects_WorkingFolder/Captain Core Documents/Data_Analysis/Data/2025CedarWestRx/Raw/"
path_out <- "S:/Protection/Fire/Ecology/effects/FireEffects_WorkingFolder/Captain Core Documents/Data_Analysis/Data/2025CedarWestRx/R_working/"

#load data 
FWD_raw <- read.csv(paste0(path_data, "Surface Fuels - Fine_XPT.csv"))
CWD_raw <-read.csv(paste0(path_data, "Surface Fuels - 1000Hr_XPT.csv"))
DuffLitt_raw <- read.csv(paste0(path_data, "Surface Fuels - Duff_Litter_XPT.csv"))
Trees_raw <-read.csv(paste0(path_data, "Trees - Individuals (metric)_XPT.csv"))
Seedlings_raw <- read.csv(paste0(path_data, "Density - Quadrats (metric)_XPT.csv"))
PostBurnSev_raw <- read.csv(paste0(path_data, "Post Burn Severity_XPT.csv"))
```

#Data Tidying
Note: Only do once. After the data is tidied, the code saves the tidy data as a csv so it can be quickly referenced in the future.
##12/7/2025 IM Consider removing non-pertinent columns (i.e. trees remove CrFuBHt:CKR)

###FWD
```{r}
#clean up dataframe 

#clean up date, extract year of the visit, separate MacroPlot.Name into Monitoring Type and Plot Number
FWD <- FWD_raw %>%
  #fix the naming convention of Cedar Plot 1
  mutate(MacroPlot.Name = ifelse(startsWith(MacroPlot.Name, "Cedar"), "B:FPIPO1T09:001", MacroPlot.Name)) %>%
  #Separate Date column into Date and Time columns
  separate(Date, sep = " ", into = c("Date", "Time")) %>%
  separate(Date, sep = "/", into = c("Month", "Day", "Year"), remove = FALSE) %>%
  select(!c("Month", "Day")) %>%
  # Separate MacroPlot.Name to get Monitoring type
  separate(MacroPlot.Name, sep = ":", into = c("BurnType", "MonitoringType", "Plot"), remove = FALSE) %>%
  # Remove relic X column
  select(!X) %>%
  # set column types
  mutate(Plot=as.factor(Plot), Year = as.numeric(Year), Monitoring.Status = factor(Monitoring.Status, levels = c("Pre01", "Post01", "Re01Year01", "Re01Year02", "Re01Year05", "Re01Year10", "Pre02", "Post02", "Re02Year01", "Re02Year05", "Pre03", "Post03")))

#Ensure blanks in visited column are NA
FWD$Visited[FWD$Visited==""] <- NA

# Filter for only data
FWD_data <- FWD %>%
  filter(is.na(Visited))

#Filter for only headers
FWD_header <- FWD %>%
  filter(!is.na(Visited))

rm(FWD, FWD_raw)

```

### CWD
```{r}
#clean up date, extract year of the visit, separate MacroPlot.Name into Monitoring Type and Plot Number
CWD <- CWD_raw %>%
  #fix the naming convention of Cedar Plot 1
  mutate(MacroPlot.Name = ifelse(startsWith(MacroPlot.Name, "Cedar"), "B:FPIPO1T09:001", MacroPlot.Name)) %>%
  #Separate Date column into Date and Time columns
  separate(Date, sep = " ", into = c("Date", "Time")) %>%
  separate(Date, sep = "/", into = c("Month", "Day", "Year"), remove = FALSE) %>%
  select(!c("Month", "Day")) %>%
  # Separate MacroPlot.Name to get Monitoring type
  separate(MacroPlot.Name, sep = ":", into = c("BurnType", "MonitoringType", "Plot"), remove = FALSE) %>%
  # Remove relic X column
  select(!X) %>%
  # set column types
  mutate(Plot=as.factor(Plot), Year = as.numeric(Year), Monitoring.Status = factor(Monitoring.Status, levels = c("Pre01", "Post01", "Re01Year01", "Re01Year02", "Re01Year05", "Re01Year10", "Pre02", "Post02", "Re02Year01", "Re02Year05", "Pre03", "Post03")))

#Ensure blanks in visited column are NA
CWD$Visited[CWD$Visited==""] <- NA

# Filter for only data
CWD_data <- CWD %>%
  filter(is.na(Visited))

#Filter for only headers
CWD_header <- CWD %>%
  filter(!is.na(Visited))

rm(CWD, CWD_raw)
```
### DuffLitt
```{r}
#clean up date, extract year of the visit, separate MacroPlot.Name into Monitoring Type and Plot Number
DuffLitt <- DuffLitt_raw %>%
  #fix the naming convention of Cedar Plot 1
  mutate(MacroPlot.Name = ifelse(startsWith(MacroPlot.Name, "Cedar"), "B:FPIPO1T09:001", MacroPlot.Name)) %>%
  #Separate Date column into Date and Time columns
  separate(Date, sep = " ", into = c("Date", "Time")) %>%
  separate(Date, sep = "/", into = c("Month", "Day", "Year"), remove = FALSE) %>%
  select(!c("Month", "Day")) %>%
  # Separate MacroPlot.Name to get Monitoring type
  separate(MacroPlot.Name, sep = ":", into = c("BurnType", "MonitoringType", "Plot"), remove = FALSE) %>%
  # Remove relic X column
  select(!X) %>%
  # set column types
  mutate(Plot=as.factor(Plot), Year = as.numeric(Year), Monitoring.Status = factor(Monitoring.Status, levels = c("Pre01", "Post01", "Re01Year01", "Re01Year02", "Re01Year05", "Re01Year10", "Pre02", "Post02", "Re02Year01", "Re02Year05", "Pre03", "Post03")))

#Ensure blanks in visited column are NA
DuffLitt$Visited[DuffLitt$Visited==""] <- NA

# Filter for only data
DuffLitt_data <- DuffLitt %>%
  filter(is.na(Visited))

#Filter for only headers
DuffLitt_header <- DuffLitt %>%
  filter(!is.na(Visited))

rm(DuffLitt, DuffLitt_raw)
```
### PostBurnSev
```{r}
#clean up date, extract year of the visit, separate MacroPlot.Name into Monitoring Type and Plot Number
PostBurnSev <- PostBurnSev_raw %>%
  #fix the naming convention of Cedar Plot 1
  mutate(MacroPlot.Name = ifelse(startsWith(MacroPlot.Name, "Cedar"), "B:FPIPO1T09:001", MacroPlot.Name)) %>%
  #Separate Date column into Date and Time columns
  separate(Date, sep = " ", into = c("Date", "Time")) %>%
  separate(Date, sep = "/", into = c("Month", "Day", "Year"), remove = FALSE) %>%
  select(!c("Month", "Day")) %>%
  # Separate MacroPlot.Name to get Monitoring type
  separate(MacroPlot.Name, sep = ":", into = c("BurnType", "MonitoringType", "Plot"), remove = FALSE) %>%
  # Remove relic X column
  select(!X) %>%
  # set column types
  mutate(Plot=as.factor(Plot), Year = as.numeric(Year), Monitoring.Status = factor(Monitoring.Status, levels = c("Pre01", "Post01", "Re01Year01", "Re01Year02", "Re01Year05", "Re01Year10", "Pre02", "Post02", "Re02Year01", "Re02Year05", "Pre03", "Post03")))

#Ensure blanks in visited column are NA
PostBurnSev$Visited[PostBurnSev$Visited==""] <- NA

# Filter for only data
PostBurnSev_data <- PostBurnSev %>%
  filter(is.na(Visited))

#Filter for only headers
PostBurnSev_header <- PostBurnSev %>%
  filter(!is.na(Visited))

rm(PostBurnSev, PostBurnSev_raw)
```
### Seedlings 
```{r}
#clean up date, extract year of the visit, separate MacroPlot.Name into Monitoring Type and Plot Number
Seedlings <- Seedlings_raw %>%
  #fix the naming convention of Cedar Plot 1
  mutate(MacroPlot.Name = ifelse(startsWith(MacroPlot.Name, "Cedar"), "B:FPIPO1T09:001", MacroPlot.Name)) %>%
  #Separate Date column into Date and Time columns
  separate(Date, sep = " ", into = c("Date", "Time")) %>%
  separate(Date, sep = "/", into = c("Month", "Day", "Year"), remove = FALSE) %>%
  select(!c("Month", "Day")) %>%
  # Separate MacroPlot.Name to get Monitoring type
  separate(MacroPlot.Name, sep = ":", into = c("BurnType", "MonitoringType", "Plot"), remove = FALSE) %>%
  # Remove relic X column
  select(!X) %>%
  # set column types
  mutate(Plot=as.factor(Plot), Year = as.numeric(Year), Monitoring.Status = factor(Monitoring.Status, levels = c("Pre01", "Post01", "Re01Year01", "Re01Year02", "Re01Year05", "Re01Year10", "Pre02", "Post02", "Re02Year01", "Re02Year05", "Pre03", "Post03")))

#Ensure blanks in visited column are NA
Seedlings$Visited[Seedlings$Visited==""] <- NA

# Filter for only data
Seedlings_data <- Seedlings %>%
  filter(is.na(Visited))

#Filter for only headers
Seedlings_header <- Seedlings %>%
  filter(!is.na(Visited))

#good! looking at the header, the sampling area for all of the reads is 250m2

rm(Seedlings, Seedlings_raw)
```

### Trees 
```{r}
#clean up date, extract year of the visit, separate MacroPlot.Name into Monitoring Type and Plot Number
Trees <- Trees_raw %>%
  #fix the naming convention of Cedar Plot 1
  mutate(MacroPlot.Name = ifelse(startsWith(MacroPlot.Name, "Cedar"), "B:FPIPO1T09:001", MacroPlot.Name)) %>%
  #Separate Date column into Date and Time columns
  separate(Date, sep = " ", into = c("Date", "Time")) %>%
  separate(Date, sep = "/", into = c("Month", "Day", "Year"), remove = FALSE) %>%
  select(!c("Month", "Day")) %>%
  # Separate MacroPlot.Name to get Monitoring type
  separate(MacroPlot.Name, sep = ":", into = c("BurnType", "MonitoringType", "Plot"), remove = FALSE) %>%
  # Remove relic X column
  select(!X) %>%
  # set column types
  mutate(Plot=as.factor(Plot), Year = as.numeric(Year), Monitoring.Status = factor(Monitoring.Status, levels = c("Pre01", "Post01", "Re01Year01", "Re01Year02", "Re01Year05", "Re01Year10", "Pre02", "Post02", "Re02Year01", "Re02Year05", "Pre03", "Post03")))

#Ensure blanks in visited column are NA
Trees$Visited[Trees$Visited==""] <- NA

# Filter for only data
Trees_data <- Trees %>%
  filter(is.na(Visited))

#Filter for only headers
Trees_header <- Trees %>%
  filter(!is.na(Visited))

rm(Trees, Trees_raw)
```

### Save tidy data as csv's 
```{r}
#save tidy data as csv
write.csv(FWD_data, paste0(path_out, "CGWestRx_FWD_data.csv"))
write.csv(FWD_header, paste0(path_out, "CGWestRx_FWD_header.csv"))
write.csv(CWD_data, paste0(path_out, "CGWestRx_CWD_data.csv"))
write.csv(CWD_header, paste0(path_out, "CGWestRx_CWD_header.csv"))
write.csv(DuffLitt_data, paste0(path_out, "CGWestRx_DuffLitt_data.csv"))
write.csv(DuffLitt_header, paste0(path_out, "CGWestRx_DuffLitt_header.csv"))
write.csv(PostBurnSev_data, paste0(path_out, "CGWestRx_PostBurnSev_data.csv"))
write.csv(PostBurnSev_header, paste0(path_out, "CGWestRx_PostBurnSev_header.csv"))
write.csv(Seedlings_data, paste0(path_out, "CGWestRx_Seedlings_data.csv"))
write.csv(Seedlings_header, paste0(path_out, "CGWestRx_Seedlings_header.csv"))
write.csv(Trees_data, paste0(path_out, "CGWestRx_Trees_data.csv"))
write.csv(Trees_header, paste0(path_out, "CGWestRx_Trees_header.csv"))
```

# Calculating Fuel Loading
12/7/2025 IM - waiting for Nick Kichas for code. Rfuels is not downloading due to newer version of R than allowed. 
## Using Rfuels

###Rfuels setup
```{r}
#install Rfuels package
install.packages("devtools")
library(devtools)
devtools::install_github('danfosterfire/Rfuels')
install.packages("Rfuels")
install.packages("Rtools")

#load Rfuels package
library(Rfuels)
```

###Reformat


# Fuels Data Visualizations

## FWD

```{r}
#summarize the FWD data by Monitoring Status for all size classes of fuel. This summarizes the minimum, maximum, mean, standard deviation, and standard error for One, Ten, and Hundred hour fuel classes.
FWD_summ <- FWD_data %>%
  group_by(Monitoring.Status) %>%
  reframe(n=n(),
            `Min.`=c(min(OneHr),min(TenHr), min(HunHr)),
            `Max.`=c(max(OneHr),max(TenHr),max(HunHr)),
            `Mean`=c(mean(OneHr),mean(TenHr),mean(HunHr)),
            `SD`=c(sd(OneHr),sd(TenHr),sd(HunHr)),
            `SE`=c(sd(OneHr)/sqrt(n),sd(TenHr)/sqrt(n),sd(HunHr)/sqrt(n)),
            'Size_class'=c("One", "Ten", "Hun"))
```

# Seedlings Data Visualizations

Calculate trees/ac of seedlings
```{r}
# Calculate trees/ac of seedlings knowing that the sampling area was 250m2
#250m2 = 0.0612 ac; 250m2 = 0.025ha
#total area for all 4 plots is 1000m2 (4*250m2)

Seedlings_data <- Seedlings_data %>%
  mutate(TPHa = Count/250*10000, Height_ft = Height * 3.28084, TPA = Count/250*4046.8564) %>%
  mutate(Height = as.factor(Height), Height_ft = as.factor(Height_ft))

Density_all_m <- Seedlings_data %>%
  group_by(Monitoring.Status, Height, Status) %>%
  summarise(Count = sum(Count),
            TPHa = Count/1000*10000) 
#In order to graph by height and status in the same graph we need to create a merged monitoring and live/dead column
#there are no dead seedlings pre burn so let's add a row that has 0 for the TPHa for Dead Pre03
temp <- tibble(Monitoring.Status = as.factor("Pre03"), Height = as.factor("0.15"), Status = "D", Count = 0, TPHa = 0, MonStat = as.factor("Pre03D"))
Density_all_m <- Density_all_m %>%
  mutate(MonStat = paste0(Monitoring.Status, Status)) %>%
  bind_rows(temp) %>%
  mutate(MonStat = factor(MonStat, c("Pre03L", "Pre03D", "Post03L", "Post03D")))


Density_all_ft <- Seedlings_data %>%
  group_by(Monitoring.Status, Height_ft) %>%
  summarise(Count = sum(Count),
            TPA = Count/1000*4046.8564)
#it looks like something weird happened in the counts for Re01Year02 and Re01Year05; very high counts for seedlings <0.15m
```

### Plot Seedling density by size class
```{r}
#metric
a <- ggplot(Density_all_m, aes(x=Monitoring.Status, y=TPHa, fill=Height)) +
  geom_bar(stat = "identity") +
  theme_bw() +
  labs(title = "Seedlings per Ha by Size Class", x = "Monitoring Status", y = "Seedlings/ha")
a

#now let's look only at the most recent burn
b <- ggplot(Density_all_m[36:48, ], aes(x=Monitoring.Status, y=TPHa, fill=Height)) +
  geom_bar(stat = "identity") +
  theme_bw() +
  labs(title = "Pre= and Post- Cedar West Rx: Seedlings per Ha by Size Class", x = "Monitoring Status", y = "Seedlings/ha")
b

#now looking only at the most recent burn, let's include the status of the seedlings (live or dead)
c <- ggplot(Density_all_m[49:66, ], aes(x=MonStat, y=TPHa, fill=Height)) +
  geom_bar(stat = "identity") +
  theme_bw() +
  labs(title = "Pre- and Post- Cedar West Rx: Seedlings per Ha by Size Class", x = "Monitoring Status Live/Dead", y = "Seedlings/ha") + geom_vline(xintercept = 2.5, linetype="dashed", color = "red", linewidth = 0.5)
c
```

###Plot Seedling size classes by species

make summary dataframes for bargraphs
```{r}
Density_sp_m <- Seedlings_data %>%
  group_by(Monitoring.Status, Height, Status, Species.Symbol) %>%
  summarise(Count = sum(Count),
            TPHa = Count/1000*10000) 

Density_all_ft <- Seedlings_data %>%
  group_by(Monitoring.Status, Height_ft, Status, Species.Symbol) %>%
  summarise(Count = sum(Count),
            TPA = Count/1000*4046.8564)
#it looks like something weird happened in the counts for Re01Year02 and Re01Year05; very high counts for seedlings <0.15m
```


```{r}
#dataframe of only Pre03 and Post03
seedlings_prepost03 <- filter(Seedlings_data, Monitoring.Status == "Pre03" | Monitoring.Status == "Post03")
Density_prepost03_m <- filter(Density_sp_m, Monitoring.Status=="Pre03" | Monitoring.Status == "Post03") 

#looking only at the most recent burn, let's include the status of the seedlings (live or dead)

#boxplot
d <- ggplot(Density_prepost03_m, aes(x=Monitoring.Status, y=TPHa, fill=Height)) +
  geom_bar(stat = "identity") +
  facet_wrap(~Species.Symbol) +
  theme_bw() +
  labs(title = "Pre- and Post- Cedar West Rx: Seedlings per Ha by Size Class and Species", x = "Monitoring Status", y = "Seedlings/ha") + geom_vline(xintercept = 1.5, linetype="dashed", color = "red", linewidth = 0.5)
d


```


# Trees Data Visualizations

##Tree Calculations 
NOTE: these calculations include all trees (Dead & Down as well) regardless of whether they all have a measured DBH. It may be worthwhile to exclude dead & down trees for a more "accurate" tree density (trees per ac).
```{r}
#Tree basal area calculation
temp <- Trees_data %>%
  #calculate basal area metric (BA_m2) and imperial (BA_ft2)
  mutate(DBH_in = DBH*0.393701, BA_m2 = pi*(DBH/2)^2/10000, BA_ft2 = pi*(DBH*0.393701/2)^2/144) %>%
  #remove DD trees because the lack of DBH messes with subsequent analyses.
  filter(!is.na(DBH))

#summarise for each monitoring status, plot, and tree status: BA, Trees/ac (or ha), and QMD
Density_trees_all_m <- temp %>%
  group_by(Monitoring.Status,MacroPlot.Name, Status) %>%
  #count instances of L/D trees in each plot (Count), calculate BA per ha of L/D trees in each plot using the individual tree's BA (BA_m2/ha) (area: 50m x 20m = 1000m2 = 0.1ha)
  summarise(Count = n(), BA_m2.ha = sum(BA_m2)/0.1) %>%
  #calculate the trees/ha using the Count and plot size (TPHa), calculate the QMD using the basal area of the stand, trees per ha, and k constant 0.00007854 
  mutate(TPHa = Count/0.1, QMD_cm = sqrt(BA_m2.ha/TPHa/0.00007854))
  
#imperial units
Density_trees_all_ft <- temp %>%
  group_by(Monitoring.Status, MacroPlot.Name, Status) %>%
  #count trees in each plot (Count), calculate BA per ac of L/D tree species in each plot using the individual tree's BA_ft2 (BA_ft2.ac) (area: 50mx20m = 1000m2 = 0.247105)
  summarise(Count = n(), BA_ft2.ac = sum(BA_ft2)/0.247105) %>%
  #calculate the trees/ha using the Count and plot size (TPHa), calculate the QMD using the basal area of the stand, trees per ha, and k constant 0.005454154 
  mutate(TPA = Count/0.247105 , QMD_in = sqrt(BA_ft2.ac/TPA/0.005454154))
  

## Calculate BA, QMD, and Tree density (TPA or TPHa) for each plot, monitoring status, tree status, and species

Density_trees_sp_m <- temp %>%
  group_by(Monitoring.Status,MacroPlot.Name, Status, Species.Symbol) %>%
  #count instances of L/D trees in each plot (Count), calculate BA per ha of L/D trees in each plot using the individual tree's BA (BA_m2/ha) (area: 50m x 20m = 1000m2 = 0.1ha)
  summarise(Count = n(), BA_m2.ha = sum(BA_m2)/0.1) %>%
  #calculate the trees/ha using the Count and plot size (TPHa), calculate the QMD using the basal area of the stand, trees per ha, and k constant 0.00007854 
  mutate(TPHa = Count/0.1, QMD_cm = sqrt(BA_m2.ha/TPHa/0.00007854)) 

#imperial units
Density_trees_sp_ft <- temp %>%
  group_by(Monitoring.Status, MacroPlot.Name, Status, Species.Symbol) %>%
  #count trees in each plot (Count), calculate BA per ac of L/D tree species in each plot using the individual tree's BA_ft2 (BA_ft2.ac) (area: 50mx20m = 1000m2 = 0.247105)
  summarise(Count = n(), BA_ft2.ac = sum(BA_ft2)/0.247105) %>%
  #calculate the trees/ha using the Count and plot size (TPHa), calculate the QMD using the basal area of the stand, trees per ha, and k constant 0.005454154 
  mutate(TPA = Count/0.247105 , QMD_in = sqrt(BA_ft2.ac/TPA/0.005454154)) 


#add an empty row for dead QUKE in Post03 to make graphs prettier
temp2 <- tibble(Monitoring.Status = as.factor("Post03"), Macro.PlotName = "B:FPIPO1T09:001", Status = "D", Species.Symbol ="QUKE1", Count = 0, BA_ft2.ac = 0, TPA = 0, QMD_in = 0)
Density_trees_sp_ft <- bind_rows(Density_trees_sp_ft, temp2)

#subset density to only the most recent pre- and post- read (Pre03 and Post03)
prepost_trees_all_ft <- filter(Density_trees_all_ft, Monitoring.Status == "Pre03" | Monitoring.Status =="Post03") 
prepost_trees_all_m <- filter(Density_trees_all_m, Monitoring.Status == "Pre03" | Monitoring.Status =="Post03") 
prepost_trees_sp_ft <- filter(Density_trees_sp_ft, Monitoring.Status == "Pre03" | Monitoring.Status =="Post03") 
prepost_trees_sp_m <- filter(Density_trees_sp_m, Monitoring.Status == "Pre03" | Monitoring.Status =="Post03") 

```

## Plotting Basal Area

Across all monitoring statuses (full dataset)
```{r}

  
```

Looking only at pre- and post-burn of most recent burn (Cedar West Rx)
```{r}
#plot all trees regardless of species. By status 
t1 <- ggplot(prepost_trees_all_ft, aes(x=Monitoring.Status, y=BA_ft2.ac, fill=Status)) +
  geom_boxplot(position = position_dodge(0.8)) +
  theme_bw() +
  labs(x="Monitoring Status", y = "Basal Area (ft^2/ac)", title = "Pre- and Post- Cedar West Rx: Basal Area by Tree Status") +
  scale_fill_manual(values = c("#665191", "#ffa600"),
                    labels = c("L" = "Live", "D" = "Dead")) + 
  geom_vline(xintercept = 1.5, linetype="dashed", color = "red", linewidth = 0.5)
t1

#now by species of tree
t2 <- ggplot(prepost_trees_sp_ft, aes(x=Monitoring.Status, y=BA_ft2.ac, fill=Status)) +
  geom_boxplot(position = position_dodge(0.8)) +
  theme_bw() +
  labs(x="Monitoring Status", y = "Basal Area (ft^2/ac)", title = "Pre- and Post- Cedar West Rx: Basal Area by Species") +
  scale_fill_manual(values = c("#665191", "#ffa600"),
                    labels = c("L" = "Live", "D" = "Dead")) + 
  geom_vline(xintercept = 1.5, linetype="dashed", color = "red", linewidth = 0.5) + 
  facet_wrap(~Species.Symbol, scales="free_y")
t2
```


## Quadratic Mean Diameter 
looking only at pre- post-burn
```{r}
#plot all trees regardless of species. By status 
t3 <- ggplot(prepost_trees_all_ft, aes(x=Monitoring.Status, y=QMD_in, fill=Status)) +
  geom_boxplot(position = position_dodge(0.8)) +
  theme_bw() +
  labs(x="Monitoring Status", y = "Quadratic Mean Diameter (in)", title = "Pre- and Post- Cedar West Rx: Quadratic Mean Diameter by Tree Status") +
  scale_fill_manual(values = c("#665191", "#ffa600"),
                    labels = c("L" = "Live", "D" = "Dead")) + 
  geom_vline(xintercept = 1.5, linetype="dashed", color = "red", linewidth = 0.5)
t3

#now by species of tree
t4 <- ggplot(prepost_trees_sp_ft, aes(x=Monitoring.Status, y=QMD_in, fill=Status)) +
  geom_boxplot(position = position_dodge(0.8)) +
  theme_bw() +
  labs(x="Monitoring Status", y = "Quadratic Mean Diameter (in)", title = "Pre- and Post- Cedar West Rx: Quadratic Mean Diameter by Species") +
  scale_fill_manual(values = c("#665191", "#ffa600"),
                    labels = c("L" = "Live", "D" = "Dead")) + 
  geom_vline(xintercept = 1.5, linetype="dashed", color = "red", linewidth = 0.5) + 
  facet_wrap(~Species.Symbol, scales="free_y")
t4
```
## Plotting Tree Density (Trees per ac or ha)
```{r}
#plot all trees regardless of species. By status 
t5 <- ggplot(prepost_trees_all_ft, aes(x=Monitoring.Status, y=TPA, fill=Status)) +
  geom_boxplot(position = position_dodge(0.8)) +
  theme_bw() +
  labs(x="Monitoring Status", y = "Trees per Acre", title = "Pre- and Post- Cedar West Rx: Trees per Acre by Tree Status") +
  scale_fill_manual(values = c("#665191", "#ffa600"),
                    labels = c("L" = "Live", "D" = "Dead")) + 
  geom_vline(xintercept = 1.5, linetype="dashed", color = "red", linewidth = 0.5)
t5

#now by species of tree
t6 <- ggplot(prepost_trees_sp_ft, aes(x=Monitoring.Status, y=TPA, fill=Status)) +
  geom_boxplot(position = position_dodge(0.8)) +
  theme_bw() +
  labs(x="Monitoring Status", y = "Trees per Acre", title = "Pre- and Post- Cedar West Rx: Trees per Acre by Species") +
  scale_fill_manual(values = c("#665191", "#ffa600"),
                    labels = c("L" = "Live", "D" = "Dead")) + 
  geom_vline(xintercept = 1.5, linetype="dashed", color = "red", linewidth = 0.5) + 
  facet_wrap(~Species.Symbol, scales="free_y")
t6
```


## Burn Metrics

Here we need to use data from the individual trees (rather than summaries used above). First let's extract only the Pre03 and Post03 trees from the original trees dataset (Trees_data)
```{r}
prepost_indiv_trees <- filter(Trees_data, Monitoring.Status == "Pre03" | Monitoring.Status == "Post03")
```

### Plot Scorch
```{r}
#Scorch Height
## by plot 
s1 <- ggplot(prepost_indiv_trees, aes(x=Plot, y=ScorchHt)) + 
  geom_boxplot() +
  theme_bw() +
  labs(x="Plot Number", y = "Scorch Height (m)", title = "Post- Cedar West Rx: Tree Scorch Height") 
 # scale_fill_manual(values = c("#665191", "#ffa600"),
 #                   labels = c("L" = "Live", "D" = "Dead")) + 
 # geom_vline(xintercept = 1.5, linetype="dashed", color = "red", linewidth = 0.5) + 
 # facet_wrap(~Species.Symbol, scales="free_y")
s1

#Scorch Percentage 


#Height to Live Crown (did the live canopy rise?)

```

